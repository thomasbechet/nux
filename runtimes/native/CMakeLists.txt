project(runtime LANGUAGES C)

set (CMAKE_C_STANDARD 99)
set (CMAKE_EXPORT_COMPILE_COMMANDS ON)

set (WAMR_BUILD_PLATFORM "linux")
set (WAMR_BUILD_TARGET "X86_64")

set (WAMR_BUILD_INTERP 1)
set (WAMR_BUILD_FAST_INTERP 1)
set (WAMR_BUILD_AOT 0)

set (WASM_BUILD_LIBC_BUILTIN 1)
set (WAMR_BUILD_LIBC_WASI 0)
set (WAMR_BUILD_LIBC_UVWASI 0)

set (WAMR_BUILD_SIMD 0)
set (WAMR_BUILD_AOT_INTRINSICS 0)

set (WAMR_BUILD_GLOBAL_HEAP_POOL 1)
set (WAMR_BUILD_ALLOC_WITH_USAGE 0)

set (WAMR_BUILD_LIB_PTHREAD 0)
set (WAMR_BUILD_TAIL_CALL 0)
set (WAMR_DISABLE_HW_BOUND_CHECK 1)
set (WAMR_DISABLE_STACK_HW_BOUND_CHECK 1)

include (${CMAKE_SOURCE_DIR}/externals/wasm-micro-runtime/build-scripts/runtime_lib.cmake)

add_executable(${PROJECT_NAME} runtime.c)

add_library(vmlib ${WAMR_RUNTIME_LIB_SOURCE})
target_link_libraries(${PROJECT_NAME} vmlib m)
set_target_properties(${PROJECT_NAME} PROPERTIES OUTPUT_NAME "nux")

include_directories(${CMAKE_SOURCE_DIR})
